<!DOCTYPE html>
<html lang="fr">
	<head>
		<meta charset="UTF-8">
		<!-- Empêche la requête automatique de favicon -->
		<link rel="icon" href="data:,">
		<title>Test Section</title>
		<style>
			body {
				font-family: Arial;
				max-width: 800px;
				margin: 0 auto;
				padding: 20px;
				background-color: #f5f5f5;
			}
			.container { 
				background: white;
				padding: 30px;
				border-radius: 10px;
				box-shadow: 0 2px 10px rgba(2, 2, 2, 0.1);
			}
			h1 {
				color: #333;
				text-align: center;
				border-bottom: 3px solid #4CAF50;
				padding-bottom: 10px;
			}
			h3 {
				color: #100daf;
				/* text-align: center; */
				padding-bottom: 10px;
			}
			.test-section {
				margin: 30px 0;
				padding: 20px;
				border: 1px solid #ddd;
				border-radius: 5px;
				background-color: #d4d4d4;
			}
			.test-section h2 {
				color: #4CAF50;
				margin-top: 0;
			}
			.test-section h3 {
				padding: 0px;
				background-color: #d4d4d4;
				color: #2b632d;
				margin-top: 10;
			}
			table {
				padding: 20px;
				border-collapse: collapse;
			}
			th, td {
				border: 2px solid black;
				padding: 10px;
				vertical-align: middle;
			}
		</style>
	</head>
	<body>
		<h1>Test Section</h1>
		<p>This page presents various commands or configurations to test on the Web Server.</p>

		<div class="test-section">
			<h2>FILE CONFIG PARSING</h2>
			<table>
				<tr>
					<td><h3>Command / Config</h3></td>
					<td><h3>Valid ?</h3></td>
				</tr>
				<tr>
					<!-- Command -->
					<td>./webserv ./config.conf</td>
					<!-- Valid ? -->
					<td> If exists : YES</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>./webserv </td>
					<!-- Valid ? -->
					<td> YES, default configuration</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>./webserv ./config.confe</td>
					<!-- Valid ? -->
					<td> NO, wrong extension</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>./webserv ./nonexistent.conf</td>
					<!-- Valid ? -->
					<td> NO, can't open file</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>no location block</td>
					<!-- Valid ? -->
					<td>YES, default location block</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>no port/address configured</td>
					<!-- Valid ? -->
					<td>YES, default port or address</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>no index</td>
					<!-- Valid ? -->
					<td>YES, default index</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>no autoindex</td>
					<!-- Valid ? -->
					<td>YES, default autoindex is off</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>listen ;</td>
					<!-- Valid ? -->
					<td>NO, invalid format</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>listen rr;</td>
					<!-- Valid ? -->
					<td>NO, invalid listen format</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>autoindex on off;</td>
					<!-- Valid ? -->
					<td>NO, invalid format</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>return &p test;</td>
					<!-- Valid ? -->
					<td>NO, invalid format</td>
				</tr>
			</table>
		</div>

		<div class="test-section">
			<h2>MULTIPORTS AND SERVER CONFIG</h2>
			<p>test the command <b>ss -tnl | grep -E ':(8080|8888|8081)</b></p>
			<table>
				<tr>
					<td><h3>Command</h3></td>
					<td><h3>Config</h3></td>
					<td><h3>Nginx</h3></td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v http://localhost:8080/</td>
					<!-- Config -->
					<td>listen 8080; </td>
					<!-- Nginx -->
					<td>200 OK</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v http://127.0.0.2:8081/</td>
					<!-- Config -->
					<td>listen 8081;</td>
					<!-- Nginx -->
					<td>200 OK</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v http://localhost:8080/</td>
					<!-- Config -->
					<td>listen 127.0.0.2;</td>
					<!-- Nginx -->
					<td>Unable to connect</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v http://127.0.0.2:8080/</td>
					<!-- Config -->
					<td>listen 127.0.0.2;</td>
					<!-- Nginx -->
					<td>200 OK</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X GET http://localhost:8080/ & curl -v -X GET http://localhost:8081/ & curl -v -X POST -H "Content-Type: text/plain" -d "test" http://localhost:8080/data/ & wait</td>
					<!-- Config -->
					<td>listen 8081; listen 8080;</td>
					<!-- Nginx -->
					<td>200 OK | 201 Created | 204 No Content</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v http://127.0.0.2:8080/</td>
					<!-- Config -->
					<td>listen 8080; index /pages/mix_page.html;</td>
					<!-- Nginx -->
					<td>200 OK</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v http://127.0.0.2:8080/data/</td>
					<!-- Config -->
					<td>listen 8080; autoindex off; index inexistent.html;</td>
					<!-- Nginx -->
					<td>403 Not Found</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v http://127.0.0.2:8080/data/</td>
					<!-- Config -->
					<td>listen 8080; autoindex on; index inexistent.html;</td>
					<!-- Nginx -->
					<td>200 OK + Listing</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X DELETE http://127.0.0.2:8080/images/image_1.jpg</td>
					<!-- Config -->
					<td>allow_methods GET;</td>
					<!-- Nginx -->
					<td>405 Not Allowed | 403 Forbidden</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X GET http://127.0.0.2:8080/images/</td>
					<!-- Config -->
					<td>location /images { return 200 "Im a test";}</td>
					<!-- Nginx -->
					<td>"Im a test"</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X GET http://127.0.0.2:8080/</td>
					<!-- Config -->
					<td>return 301 http://localhost:8888/;</td>
					<!-- Nginx -->
					<td>301 Moved Permanently</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X GET http://127.0.0.2:8080/images/</td>
					<!-- Config -->
					<td>location /images { return http://localhost:8080/;}</td>
					<!-- Nginx -->
					<td>301 Moved Permanently</td>
				</tr>
			</table>
		</div>

		<div class="test-section">
			<h2>HTTP/1.1 REQUEST</h2>
			<table>
				<tr>
					<td><h3>Command</h3></td>
					<td><h3>Nginx</h3></td>
					<td><h3>Config / Comment</h3></td>
				</tr>
				<tr>
					<!-- Command -->
					<td>echo -e "GET / HTTP/1.1\r\nContent-Length 100\r\n" | nc localhost 8080</td>
					<!-- Nginx -->
					<td>400 Bad Request</td>
					<!-- Config -->
					<td>Wrong Header syntax (miss :)</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>echo -e "GET / HTTP/1.1\r\Host: \r\n" | nc localhost 8080</td>
					<!-- Nginx -->
					<td>400 Bad Request</td>
					<!-- Config -->
					<td>Miss argument for the Header</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl "http://localhost:8080/path%00with%00nulls"</td>
					<!-- Nginx -->
					<td>400 Bad Request</td>
					<!-- Config -->
					<td>Wrong URL</td>
					<td> TO FIX - BUG</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>echo -e "POST /data/ HTTP/1.1\r\nHost: localhost\r\nContent-Length: 2\r\n\r\n1234" | nc localhost 8080</td>
					<!-- Nginx -->
					<td>400 Bad Request </td>
					<!-- Config -->
					<td>Content-Length is incorrect</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>echo -e "POST /data/ HTTP/1.1\r\nHost: localhost\r\n\r\n123456" | nc localhost 8080</td>
					<!-- Nginx -->
					<td>411 Length Required | 400 Bad Request</td>
					<!-- Config -->
					<td>Content-Length is absent but mandatory</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -X PATCH http://localhost:8080/</td>
					<!-- Nginx -->
					<td>501 Not Implemented</td>
					<!-- Config -->
					<td>Method is not implemented in this server</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>echo -e "GET / HTTP/2.0\r\n\r\n" | nc localhost 8080</td>
					<!-- Nginx -->
					<td>505 HTTP Version Not Supported</td>
					<!-- Config -->
					<td> </td>
				</tr>
				<tr>
					<!-- Command -->
					<td>echo -e "GET / HTTP/1.1\r\n\r\n" | nc localhost 8080</td>
					<!-- Nginx -->
					<td>400 Bad request</td>
					<!-- Config -->
					<td>Header Host is missing but mandatory</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -I -X GET http://localhost:8080/data/test.txt</td>
					<!-- Nginx -->
					<td>200 OK</td>
					<!-- Config -->
					<td>Check all headers are correct in the response.</td>
				</tr>
			</table>
			<p>Est-ce que si "Accept = text/html", si j'envoie du css doit etre une erreur ?</p>
		</div>

		<div class="test-section">
			<h2>GET</h2>
			<table>
				<tr>
					<td><h3>Command</h3></td>
					<td><h3>Config / Comment</h3></td>
					<td><h3>Nginx</h3></td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X GET localhost:8080/ </td>
					<!-- Config / Comment -->
					<td>index index.html /pages/index.html;</td>
					<!-- Nginx -->
					<td>200 OK</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X -X GET localhost:8080/Non_existent</td>
					<!-- Config / Comment -->
					<td>Resource doesn't exists</td>
					<!-- Nginx -->
					<td>404 Not Found</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X GET localhost:8080/upload</td>
					<!-- Config / Comment -->
					<td>Must send back a new URL in Location</td>
					<!-- Nginx -->
					<td>301 Moved Permanently | Location:http://localhost:8080/upload/</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X GET localhost:8080/upload/</td>
					<!-- Config / Comment -->
					<td>autoindex on</td>
					<!-- Nginx -->
					<td>200 OK | Listing directory</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X GET localhost:8080/upload/</td>
					<!-- Config / Comment -->
					<td>autoindex off</td>
					<!-- Nginx -->
					<td>403 Forbidden</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X GET localhost:8080/upload/test.txt</td>
					<!-- Config / Comment -->
					<td>Returns the corresponding resource</td>
					<!-- Nginx -->
					<td>200 OK</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X GET localhost:8080/pages/forbidden.html</td>
					<!-- Config / Comment -->
					<td>Remove rights on the resource</td>
					<!-- Nginx -->
					<td>403 Forbidden</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X GET localhost:8080/images/image_2.png --output test.png</td>
					<!-- Config / Comment -->
					<td>Check response headers too</td>
					<!-- Nginx -->
					<td>200 OK | Content-Type: image/png | Content-Length: 1842505</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X GET localhost:8080//upload///test.txt</td>
					<!-- Config / Comment -->
					<td>Check response headers too</td>
					<!-- Nginx -->
					<td>200 OK | Content-Type: text/plain | Content-Length: 125</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X GET localhost:8080/data/éèàç.txt</td>
					<!-- Config / Comment -->
					<td></td>
					<!-- Nginx -->
					<td>404 Not Found</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X GET localhost:8080/data/large_file.txt</td>
					<!-- Config / Comment -->
					<td>yes "Test." | head -c 1104658150 >> ./42/webserv/www/data/very_large_file.txt</td>
					<!-- Nginx -->
					<td>200 OK</td>
				</tr>
			</table>
		</div>

		<div class="test-section">
			<h2>DOWNLOAD</h2>
			<table>
				<tr>
					<td><h3>Command</h3></td>
					<td><h3>Nginx</h3></td>
					<td><h3>Config / Comment</h3></td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -o test_image.jpg http://localhost:8080/images/image_1.jpg</td>
					<!-- Nginx -->
					<td>200 OK</td>
					<!-- Config / Comment -->
					<td>compare both images</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -o downloaded_test.txt http://localhost:8080/data/test.txt</td>
					<!-- Nginx -->
					<td>200 OK</td>
					<!-- Config / Comment -->
					<td>diff ./data/test.txt downloaded_test.txt == should return nothing</td>
				</tr>
			</table>
		</div>

		<div class="test-section">
			<h2>POST - UPLOAD</h2>
			<table>
				<tr>
					<td><h3>Command</h3></td>
					<td><h3>Config</h3></td>
					<td><h3>Return</h3></td>
				</tr>
				<tr>
					<!-- Command -->
					<td>echo -e "POST /data/ HTTP/1.1\r\nHost: localhost\r\nContent-Type: text/plain\r\nContent-Length: 6\r\n\r\n123456" | nc localhost 8080</td>
					<!-- Config -->
					<td>In our server we handle POST of data in native way, according to some rules</td>
					<!-- Return -->
					<td>201 Created | 204 No Content</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>echo -e "POST /images/ HTTP/1.1\r\nHost: localhost\r\nContent-Type: text/plain\r\nContent-Length: 6\r\n\r\n123456" | nc localhost 8080</td>
					<!-- Config -->
					<td>POST method is not allowed in this route</td>
					<!-- Return -->
					<td> 405 Method Not Allowed</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>echo -e "POST /data/ HTTP/1.1\r\nHost: localhost\r\nContent-Type: text/plain\r\nContent-Length: 6\r\n\r\n123456" | nc localhost 8080</td>
					<!-- Config -->
					<td>Remove right on the file or directory</td>
					<!-- Return -->
					<td>403 Forbidden</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X POST -F "name=André" -F "file=/www/images/image_1.jpg" -F "description=Test file upload" http://localhost:8080/upload/</td>
					<!-- Config -->
					<td>Directory must allow POST and the request body correct</td>
					<!-- Return -->
					<td>201 Created</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X POST -F "name=Karine" -F "file=@./www/data/test.txt" -F "description=Test file upload" http://localhost:8080/upload/</td>
					<!-- Config -->
					<td>Directory must allow POST and the request body correct</td>
					<!-- Return -->
					<td>201 Created</td>
				</tr>
			</table>
		</div>

		<div class="test-section">
			<h2>DELETE</h2>
			<table>
				<tr>
					<td><h3>Command</h3></td>
					<td><h3>Config</h3></td>
					<td><h3>Response</h3></td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X DELETE http://localhost:8080/pages/gallery_page.html</td>
					<!-- Config -->
					<td>allow_methods GET;</td>
					<!-- Response -->
					<td>405 Not Allowed</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X DELETE http://localhost:8080/upload/nonexistent.html</td>
					<!-- Config -->
					<td>allow_methods POST DELETE;</td>
					<!-- Response -->
					<td>404 Not Found</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X DELETE http://localhost:8080/upload/forbidden.html</td>
					<!-- Config -->
					<td>Remove rights of the resource</td>
					<!-- Response -->
					<td>403 Forbidden</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X DELETE http://localhost:8080/upload/file.txt</td>
					<!-- Config -->
					<td>Create the resource before</td>
					<!-- Response -->
					<td>204 No Content</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X DELETE http://localhost:8080/upload/test/</td>
					<!-- Config -->
					<td>Create the directory with resources in it</td>
					<!-- Response -->
					<td>204 No Content</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X DELETE http://localhost:8080/upload/file.txt & curl -v -X DELETE http://localhost:8080/upload/file.txt</td>
					<!-- Config -->
					<td>Delete the same file twice</td>
					<!-- Response -->
					<td>204 No Content && 404 Not Found</td>
				</tr>
			</table>
		</div>

		<div class="test-section">
			<h2>CGI</h2>
			<table>
				<tr>
					<td><h3>Command</h3></td>
					<td><h3>Response</h3></td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v http://localhost:8080/cgi-bin/form.php</td>
					<!-- Nginx -->
					<td>200 OK</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v http://localhost:8080/cgi-bin/hello.py</td>
					<!-- Nginx -->
					<td>200 OK</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v http://localhost:8080/form.php</td>
					<!-- Nginx -->
					<td>200 OK</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v http://localhost:8080/hello.py</td>
					<!-- Nginx -->
					<td>200 OK</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X POST -d "name=Jean" -d "email=jean@example.com" http://localhost:8080/process.php</td>
					<!-- Nginx -->
					<td>200 OK</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v "http://localhost:8080/test.php?data=Bonjour%20a%20tous"</td>
					<!-- Nginx -->
					<td>200 OK</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v "http://localhost:8080/test_strict.php?data=Bonjour%20a%20tous"</td>
					<!-- Nginx -->
					<td>200 OK</td>
				</tr>
			</table>
		</div>

		<div class="test-section">
			<h2>CLIENT CONNECTION</h2>
			<table>
				<tr>
					<td><h3>Command</h3></td>
					<td><h3>Return</h3></td>
					<td><h3>Comment</h3></td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -H "Connection: keep-alive" http://localhost:8080/ http://localhost:8080/data/test.txt</td>
					<!-- Return -->
					<td>200 OK | Connection: keep-alive</td>
					<!-- Comment -->
					<td>Connection should be left intact (except by timeout)</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -H "Connection: close" http://localhost:8080/ http://localhost:8080/data/test.txt</td>
					<!-- Return -->
					<td>200 OK | Connection: close</td>
					<!-- Comment -->
					<td>Connection should be closed</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>curl -v -X GET http://localhost:8080/</td>
					<!-- Return -->
					<td>200 OK</td>
					<!-- Comment -->
					<td>Try to TIMEOUT the client and check if the connection is closed</td>
				</tr>
				<tr>
					<!-- Command -->
					<td>siege -b -c 25 -t 2m http://localhost:8080/</td>
					<!-- Return -->
					<td>Availability: 99.50% or more, Failed transactions: 0 </td>
					<!-- Comment -->
					<td> </td>
				</tr>
				<tr>
					<!-- Command -->
					<td>watch -n 2 'echo "=== Connexions actives ==="; ss -tuln | grep :8080; echo "=== Connexions établies ==="; ss -t | grep :8080'</td>
					<!-- Return -->
					<td>Connection are closed at the end and don't accumulate</td>
					<!-- Comment -->
					<td>Test monitoring</td>
				</tr>
			</table>
		</div>

	</body>
</html>